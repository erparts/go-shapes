//kage:unit pixels
package main

func Fragment(_ vec4, sourceCoords vec2, _ vec4, customVAs vec4) vec4 {
	scaling, reveal := customVAs.xy, customVAs.z
	relCoords := sourceCoords - imageSrc0Origin()
	maskCoords := relCoords * scaling
	maskAlpha := imageSrc1At(maskCoords + imageSrc0Origin()).a

	if reveal == 0 || reveal < maskAlpha {
		return vec4(0)
	} else {
		return imageSrc0UnsafeAt(sourceCoords)
	}
}
