//kage:unit pixels
package main

func Fragment(_ vec4, sourceCoords vec2, _ vec4, customVAs vec4) vec4 {
	srcColor := imageSrc0UnsafeAt(sourceCoords)
	scaling := customVAs.xy
	relCoords := sourceCoords - imageSrc0Origin()
	maskCoords := relCoords * scaling
	maskAlpha := imageSrc1At(maskCoords + imageSrc0Origin()).a
	return srcColor * maskAlpha
}
